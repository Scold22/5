<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ù„ÙˆØ­Ø© Ø§Ù„Ø®Ù„Ø§ÙŠØ§</title>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<style>
body {
  font-family: Arial;
  text-align: center;
}

#grid {
  display: grid;
  grid-template-columns: repeat(5, 60px);
  gap: 5px;
  justify-content: center;
}

.cell {
  width: 60px;
  height: 60px;
  background: #ddd;
  cursor: pointer;
  border-radius: 8px;
}

.orange { background: orange; }
.green { background: #4CAF50; }
</style>
</head>
<body>

<h1>Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ù‚Ø¯Ù…</h1>

<p id="pressed"></p>

<div id="grid"></div>

<button onclick="assign('orange')">ğŸŸ  Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ</button>
<button onclick="assign('green')">ğŸŸ¢ Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø®Ø¶Ø±</button>

<script>
const firebaseConfig = {
  apiKey: "API_KEY",
  databaseURL: "DATABASE_URL"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

const pressRef = db.ref("press");
const gridRef = db.ref("grid");

let selectedCell = null;

// Ø´Ø¨ÙƒØ© Ø§Ù„Ø®Ù„Ø§ÙŠØ§
const grid = document.getElementById("grid");
for (let i = 0; i < 25; i++) {
  const d = document.createElement("div");
  d.className = "cell";
  d.onclick = () => selectedCell = i;
  grid.appendChild(d);
}

// Ø¹Ø±Ø¶ Ø£ÙˆÙ„ Ø¶ØºØ·Ø©
pressRef.on("value", snap => {
  if (snap.exists()) {
    document.getElementById("pressed").innerText =
      "Ø£ÙˆÙ„ Ø¶ØºØ·Ø©: " + snap.val().team;
  }
});

// Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙØ±ÙŠÙ‚ ÙˆØªÙ„ÙˆÙŠÙ† Ø§Ù„Ø®Ù„ÙŠØ©
function assign(team) {
  if (selectedCell === null) return alert("Ø§Ø®ØªØ± Ø®Ù„ÙŠØ©");

  gridRef.child(selectedCell).transaction(c => {
    if (c === null) return team;
    return;
  });

  pressRef.remove(); // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø²Ø± Ù„Ù„Ø¬ÙˆÙ„Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©
  selectedCell = null;
}

// ØªØ­Ø¯ÙŠØ« Ù…Ø¨Ø§Ø´Ø± Ù„Ù„Ø´Ø¨ÙƒØ©
gridRef.on("value", snap => {
  const cells = document.querySelectorAll(".cell");
  cells.forEach(c => c.className = "cell");

  snap.forEach(child => {
    cells[child.key].classList.add(child.val());
  });
});
</script>

</body>
</html>
